"use strict";(self["webpackChunkdiplomska"]=self["webpackChunkdiplomska"]||[]).push([[39],{39:function(e,t,o){o.r(t),o.d(t,{default:function(){return D}});var n=o(252),i=o(577),s=o(963);const l={class:"row"},a=(0,n._)("div",{class:"col-xl-2"},null,-1),r={class:"col-xl-8"},p={class:"row mt-2 p-3 fw-bold fs-3"},c={class:"col-6"},y={class:"col-6 text-end"},u={class:"ms-3 me-3 video-box text-center"},d={id:"video",class:"rounded shadow",autoplay:"",playsinline:""},k={id:"output",class:"rounded shadow"},m=(0,n._)("div",{class:"text-center mt-3"},[(0,n._)("span",{class:"counter fw-bold",id:"counter"},"0")],-1),f={class:"mt-2"},h=(0,n._)("span",{class:"fw-bold fs-3 ms-3",id:"status"},"Form: ok!",-1),x=[h],g=(0,n._)("div",{class:"col-xl-2"},null,-1);function v(e,t,o,h,v,w){return(0,n.wg)(),(0,n.iD)("div",l,[a,(0,n._)("div",r,[(0,n._)("div",p,[(0,n._)("div",c,(0,i.zw)(e.$route.params.exerciseName),1),(0,n._)("div",y,(0,i.zw)(v.timerOutput),1)]),(0,n._)("div",u,[(0,n.wy)((0,n._)("video",d,null,512),[[s.F8,!1]]),(0,n.wy)((0,n._)("canvas",k,null,512),[[s.F8,!0]])]),m,(0,n.wy)((0,n._)("div",f,x,512),[[s.F8,"Deadlift"===e.$route.params.exerciseName]])]),g])}const w=o(677);var T={name:"PerformExercise",data(){return{timer:0,timerOutput:"00:00"}},mounted(){w.setupVideo(),w.startPoseDetection(this.$route.params.exerciseName),this.startTimer()},beforeUnmount(){w.stopVideo()},methods:{startTimer:function(){setInterval((()=>{this.timer++;let e=this.timer;if(e<60)e<10&&(e="0"+e),this.timerOutput="00:"+e;else{let t=Math.floor(e/60),o=e%60;t<10&&(t="0"+t),o<10&&(o="0"+o),this.timerOutput=t+":"+o}}),1e3)}}},M=o(744);const b=(0,M.Z)(T,[["render",v]]);var D=b},677:function(e,t,o){let n,i,s,l,a,r;o.r(t),o.d(t,{repCounter:function(){return s},setupVideo:function(){return k},startPoseDetection:function(){return d},stopVideo:function(){return m}});let p,c,y,u="";function d(e){console.log("exercise:"+e),n=null,i=null,s=0,l=!0,a=!1,r=e;const t=document.getElementById("video");t.onloadedmetadata=()=>{p=document.getElementById("video"),c=document.getElementById("output"),c.width=p.videoWidth,c.height=p.videoHeight,y=c.getContext("2d"),y.fillStyle="red",f().then((()=>requestAnimationFrame(x)))}}function k(){console.log("Setting up video...");const e=document.getElementById("video");navigator.mediaDevices.getUserMedia({audio:!1,video:!0}).then((function(t){e.srcObject=t}));console.log("DONE!")}function m(){console.log("Stopping video..."),p.srcObject.getTracks().forEach((e=>e.stop())),p.srcObject=null,a=!0,console.log("DONE!")}async function f(){console.log("Starting detector..."),i=await poseDetection.createDetector(poseDetection.SupportedModels.MoveNet,{minPoseScore:.5}),console.log("DONE!")}async function h(){n=await i.estimatePoses(p)}function x(){a||(y.drawImage(p,0,0,c.width,c.height),h().then((()=>{switch(g(),v(),r){case"Push up":w.printPushup();break;case"Deadlift":w.printDeadlift(),w.printFormDeadlift();break;case"Squat":w.printSquat();break;default:console.log("Error: exercise not found!");break}})).catch((e=>{console.log("Cannot detect landmarks!")})),requestAnimationFrame(x))}function g(){for(let e=0;e<16;e++){let t=n[0]["keypoints"][e].x,o=n[0]["keypoints"][e].y;y.beginPath(),y.arc(t,o,3,0,2*Math.PI),y.fill()}}function v(){y.beginPath(),y.strokeStyle="green",y.lineWidth=4,y.moveTo(n[0]["keypoints"][10].x,n[0]["keypoints"][10].y),y.lineTo(n[0]["keypoints"][8].x,n[0]["keypoints"][8].y),y.lineTo(n[0]["keypoints"][6].x,n[0]["keypoints"][6].y),y.lineTo(n[0]["keypoints"][5].x,n[0]["keypoints"][5].y),y.lineTo(n[0]["keypoints"][7].x,n[0]["keypoints"][7].y),y.lineTo(n[0]["keypoints"][9].x,n[0]["keypoints"][9].y),y.moveTo(n[0]["keypoints"][6].x,n[0]["keypoints"][6].y),y.lineTo(n[0]["keypoints"][12].x,n[0]["keypoints"][12].y),y.lineTo(n[0]["keypoints"][14].x,n[0]["keypoints"][14].y),y.lineTo(n[0]["keypoints"][16].x,n[0]["keypoints"][16].y),y.moveTo(n[0]["keypoints"][5].x,n[0]["keypoints"][5].y),y.lineTo(n[0]["keypoints"][11].x,n[0]["keypoints"][11].y),y.lineTo(n[0]["keypoints"][13].x,n[0]["keypoints"][13].y),y.lineTo(n[0]["keypoints"][15].x,n[0]["keypoints"][15].y),y.moveTo(n[0]["keypoints"][12].x,n[0]["keypoints"][12].y),y.lineTo(n[0]["keypoints"][11].x,n[0]["keypoints"][11].y),y.stroke()}const w={printDeadlift:()=>{let e=n[0]["keypoints"][6].x,t=n[0]["keypoints"][6].y,o=n[0]["keypoints"][12].x,i=n[0]["keypoints"][12].y,a=e-o,r=t-i,p=Math.sqrt(a*a+r*r);p<50&&!l&&(s++,M(),l=!l),p>90&&l&&(l=!l);let c="deadlifts: "+s+" - "+p+"px";console.log("%c "+c,"font-size: 20px")},printPushup:()=>{let e=n[0]["keypoints"][5].x,t=n[0]["keypoints"][5].y,o=n[0]["keypoints"][7].x,i=n[0]["keypoints"][7].y,a=n[0]["keypoints"][9].x,r=n[0]["keypoints"][9].y,p=T(e,t,o,i,a,r);p>160&&!l&&(s++,l=!l),p<110&&l&&(l=!l);let c="Pushups: "+s+" - Angle: "+p+"*";console.log("%c "+c,"font-size: 20px")},printSquat:()=>{let e=n[0]["keypoints"][16].x,t=n[0]["keypoints"][16].y,o=n[0]["keypoints"][12].x,i=n[0]["keypoints"][12].y,a=e-o,r=t-i,p=Math.sqrt(a*a+r*r);p<100&&!l&&(s++,l=!l),p>150&&l&&(l=!l);let c="Squats: "+s+" - "+p+"px";console.log("%c "+c,"font-size: 20px")},printFormDeadlift:()=>{let e=n[0]["keypoints"][14].x,t=n[0]["keypoints"][14].y,o=n[0]["keypoints"][12].x,i=n[0]["keypoints"][12].y,s=n[0]["keypoints"][11].x,l=n[0]["keypoints"][11].y,a=T(e,t,o,i,s,l);u="OK",a>100&&(u="legs too wide!"),a<90&&(u="legs too narrow!");let r=n[0]["keypoints"][5].y,p=n[0]["keypoints"][11].y,c=n[0]["keypoints"][6].y,y=n[0]["keypoints"][12].y,d="OK";(r>p||c>y)&&(d="Upper back too low!"),b(u)}};function T(e,t,o,n,i,s){let l=Math.sqrt(Math.pow(o-e,2)+Math.pow(n-t,2)),a=Math.sqrt(Math.pow(o-i,2)+Math.pow(n-s,2)),r=Math.sqrt(Math.pow(i-e,2)+Math.pow(s-t,2));return 180*Math.acos((a*a+l*l-r*r)/(2*a*l))/Math.PI}function M(){document.getElementById("counter").innerHTML=s}function b(e){document.getElementById("status").innerHTML="Form: "+e}}}]);
//# sourceMappingURL=39.a08aaec3.js.map